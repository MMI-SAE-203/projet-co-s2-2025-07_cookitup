---
export interface Props {
    id?: string;
    nom?: string;
    img?: string;
    calories?: number;
    regime?: string[];
}

const {
    id = "1",
    nom = "RECETTE",
    img = "/placeholder.svg",
    calories = null,
    regime = [],
} = Astro.props;

// âœ… CORRECTION : Utiliser "img" au lieu de "image"
const imageUrl = img
    ? `http://127.0.0.1:8090/api/files/recettes/${id}/${img}`
    : "/placeholder.svg";
---

<div
    class="relative min-w-[200px] h-64 rounded-lg overflow-hidden shadow-lg hover:shadow-xl transition-shadow snap-start"
>
    <img
        src={imageUrl || "/placeholder.svg"}
        alt={nom}
        class="w-full h-full object-cover"
    />
    <div class="absolute inset-0 bg-black bg-opacity-40 flex items-end">
        <div class="p-4 w-full">
            <h3 class="text-white font-bold text-lg uppercase mb-2">{nom}</h3>

            <div class="flex flex-wrap gap-1 mb-2">
                {
                    calories && (
                        <span class="bg-orange-500/80 text-white px-2 py-1 rounded text-xs font-medium">
                            ğŸ”¥ {calories} cal
                        </span>
                    )
                }

                {
                    regime &&
                        regime.length > 0 &&
                        regime.slice(0, 2).map((regimeType) => {
                            const regimeConfig = {
                                vÃ©gÃ©tarien: "ğŸŒ±",
                                vÃ©gan: "ğŸŒ¿",
                                "sans-gluten": "ğŸŒ¾",
                                halal: "â˜ªï¸",
                            };
                            const icon = regimeConfig[regimeType] || "ğŸ½ï¸";

                            return (
                                <span class="bg-white/20 text-white px-2 py-1 rounded text-xs font-medium">
                                    {icon}
                                </span>
                            );
                        })
                }
            </div>
        </div>
    </div>

    <a
        href={`/recette-plat/${id}`}
        class="absolute inset-0"
        aria-label={`Voir la recette ${nom}`}></a>
</div>
